# TCP新

## 概览

先看一下：OSI TCP/IP4 对比

![TCP-OSI.png](image/TCP-OSI.png)

> OSI参考模型的过于庞大、复杂招致了许多批评。

数据的传输的过程：都是逐层向下增加报文头

![204912498d406e38ab40704c80ec2d1d.jpg](image/204912498d406e38ab40704c80ec2d1d.jpg)

> 图上，用户发送一次数据的大概过程。经过每层，都需要在原数据前面加上本层的信息。

TCP/IP：实际是上一组协议，大体上分为：TCP协议\+IP协议组成

TCP协议负责的是本机数据的处理：数据拆分包、传输的稳定性、端口映射进程等，而网络的路由，对端机器的寻找，这些交给IP层来做，最后加上物理层传输二进制数据，基本上就满足了网络请求

## TCP

transmission control protocol ，传输控制协议

TCP\-数据格式：

![TCP.png](image/TCP.png)

1. 源端口号\(16位\)

> 从上面看到端口号：2^16=65535个

1. 目录端口号\(16位\)
2. 初始序号ISN\-顺序号\(32位\)
3. 确认序号\(32位\)
4. 头部长度/数据偏移\(4位\)
5. 保留
6. 标志位，6位
    1. URG：紧急指针
    2. ACK\(Acknowledgement\):确认序号有效
    3. PSH：接收方应该尽快将这个报文段交给应用层
    4. RST：重新连接SYN：同步序号用来发起一个连接
    5. SYN表示SYN报文（在建立TCP连接的时候使用）
    6. FIN：发端完成任务
7. 滑动窗口大小\(16位\)
8. 校验和\(16位\)
9. 紧急指针\(16位\)
10. 可选项\(8的整数倍\)
11. 数据

#### 分析

相比IP协议，TCP可要复杂不少

1. 连接机制：建立连接，断开连接

> 确认号、顺序号、连接标志

1. 滑动窗口机制\(保证可靠传输，并且有顺序性\)

> 另外我们看到，TCP里没有IP地址信息，TCP并不是关心网络层的事情，更关心:数据的传输，端口映射进程的相关事情

## TCP创建连接

![TCP-CONN.png](image/TCP-CONN.png)

#### 基础术语

顺序号\(sn\):32位\-正整数\(0~4294967294\)

确认号\(ack\):接收方，把发送方发来的顺序号\+1

x：任意一个自然整数，由客户端系统生成，也是sn号

y：任意一个自然整数，由服务器系统生成，也是sn号

客户端状态：

1. SYN\_SENT：请求连接状态
2. ESTABLISHED：连接成功
3. CLOSED：连接关闭

服务端状态：

1. LISTENING：监听状态
2. SYN\-RCVD状态:收到和发送一个连接请求后等待对方对连接请求的确认
3. ESTABLISHED状态:连接成功

#### 三次握手

第一次握手：客户端发送包\(头\), flags 字段中的 SYN=1 ，随机生成一个数:x，sn=x,到服务器，并进入SYN\_SEND状态，等待服务器确认

第二次握手：服务器收到包\(头\),，判断 SYN=1，是要建立连接，于是，返回包\(头\)：随机生成一个数y, SYN=1,ACK=1,sn=y,ack=X\+1，此时服务器进入SYN\_RECV状态

第三次握手：收到服务器的包\(头\)：判断 SYN=1，ACK=1，这是确认连接，然后，向服务器发送确认包头：ACK=1，sn=x\+1、ack=y\+1\)，客户端进入 ESTABLISHED 状态

服务端接收到客户端的确认信息后，进入 ESTABLISHED 状态 完成三次握手。

> 看着是3次握手，实际两端要处理逻辑其实共计是4次，3次更多的是指网络请求走了3次而已

整个过程：只需要处理头信息即可，包里并没有任何数据。两端各生成一个随机数，以确保是安全的连接

发送数据

当连接那上成功后就要发送数据了，正常一个数据段，可能很长，也可能很短。拿比较长的来说，数据先会被写到缓冲区，然后打包成TCP报文段，直到最后一段数据进来，再次进行打包，然后加此报文的flags中的psh置成1，ack设置成1，统一发送出去。

接收方，会把报文，依次放入到 读，缓冲区。如果全部收全且发现有psh标识,则立刻通知应用层进程，来拿数据。再返回给发送方一个ACK~之后。

这里，如果保证发送方的数据，接收方都能够接全。就牵扯到 窗口滑动机制了。

## TCP关闭连接

> 结合上面的图

4次握手：

1. A发了关闭请求 \(FIN=1、seq=x、ack=z\)，状态变成：fin\_wait\_1状态
2. B接收到，判断标识位FIN=1\(seq=z、ack=x\+1\)关闭了其中一个通路，然后给A发起一个ACK
3. A接收ACK确认此条线路被关闭，状态切换到 fin\_wait\_2状态.B再发出关闭请求FIN，进入last\_ack状态
4. A收到关闭ADK请求，然后再给A发送一个ACK，进入time\_wait 状态

> A经过2个MSL后，自动关闭此条连接

最后，B接收到，判断标识位FIN=1\(seq=x、ack=y\)再关闭一条通道，到此全关闭了

MSL是Maximum Segment Lifetime的英文缩写，可译为“最长报文段寿命”，它是任何报文在网络上存在的最长的最长时间，超过这个时间报文将被丢弃。

## TCP连接的漏洞

#### 半连接

当服务端接收到C端的连接请求后，会发包，然后进入 SYN\-RCVD 状态，而如果迟迟等不到C端的第三次握手请求，就会产生一堆的半连接

未连接队列：在三次握手协议中，服务器维护一个未连接队列，该队列为每个客户端的SYN包（syn=j）开设一个条目，该条目表明服务器已收到SYN 包，并向客户发出确认，正在等待客户的确认包。

这些条目所标识的连接在服务器处于 Syn\_RECV 状态，当服务器收到客户的确认包时，删除该条目，服务器进入ESTABLISHED状态。

#### time\-wait

在高并发情且短连接情况下，如：HTTP协议，服务端大多会主动断开TCP连接，那么，在timewait状态下，要等待2msl的时间，这会造成socket数量不够用

## TCP窗口滑动

当进程，将要发送的数据，发送到缓冲区后~该区域就把所有数据打上4种标识

1、已发送并确认过的数据

2、已发送未确认过的数据

3、接下来，即将要发送的数据

4、未发送的数据

实际上，2、3步骤，会被一个 虚拟的 窗口覆盖上~当2步数据经过确认后，窗口自动向右滑动。

## UDP

user data protocol 用户数据报协议不可靠的、无连接的数据报服务，实际更深入的了解是：没有进行3次握手，也就是没有校验的过程，直接将报文头\+数据，发送给目的主机。![a970d7b1a3a591f2dfcb35413cb914ae.jpg](image/a970d7b1a3a591f2dfcb35413cb914ae.jpg)

通过以上，实际上个人的理解是：IP处理的是主机到主机的通信，而TCP处理的是一台机器上端口到端口的通信，也就是进程之间的通信。

最初，为了实现几台，或者一栋楼里的机器互联，就产生了IP路由器，也就是网关

## MSS

Maximum Segment Size：最大报文段，是TCP协议的一个选项。

MSS选项用于在TCP建立连接时，收发双方协商一个TCP报文段所能承载的最大数据长度。MSS选项只在初始化连接请求\(SYN=1\)的报文段中使用。选择合适的MSS很重要。如果MSS小了，网络利用率低。如果MSS大了，由于在网络层需要分片，也会影响网络性能。一般MSS的长度为MTU\(1500\)\-IP首部\(20\)\-TCP首部\(20\)=1460字节。

5元组

一个新连接，在服务器端，是一个SOCK，FD。也就是是一个连接文件，该文件的标识：源IP\+源端口\+TCP/UDP\+目标IP\+目标端口

## keepalive

keepalive:保活机制。

拿linux socket来说，虽然各种书籍文档都说网络要建立连接，而这个'连接'并不是真实有个链接，道理很简单：真要是有根物理的网张创建连接，那一个服务器得有多少条这样的网线？不现实。

实际就是：双方做个验证，留个TOKEN之类的，再由OS接管，弄2个socket FD，而已。

那么，这条虚拟的连接，如果双方不消息，双方又如何知道对方是否还在线呢？

FIN这种关闭是有很多问题的，如：

1. 对方进程挂了，OS直接无视，根本没来得及发FIN，
2. 某一方网络出了问题，也发不出去FIN
3. 某方CPU计算量非常大，而当前进程拿不到CPU资源，只能等待。
4. 丢包
    ....

> 发不出去FIN的情况其实很多的......

headerbeat：心跳机制，对于上面说的两端如何知道对方在线？其实也没有太好的办法，异常太多，于是 就有了一种折中的方案：两端定时发送一个空包，一但超过一定时间 未接收到，就证明对方可能网络出现了问题，就可以主动关闭了

TCP\-keepalive

> cat /proc/sys/net/ipv4/

3个重要参数：:

tcp\_keepalive\_time：默认 7200 秒

tcp\_keepalive\_probes：默认 9 次

tcp\_keepalive\_intvl：默认 75 秒

> 7200秒后，对方没有响应，就发送一个探测包，之后每75秒后再发送一个包，发送9次没响应，关闭连接

应用层\-heartbeat

虽然TCP已有了KEEPALIVE，但问题是，以TCP层，只是能确定，连接是否存在 ，并不能确认该连接是否还能传输数据，比如：对方主机假死，连接在，不能接收数据了

## 待解决

mmap内存映射

LINUX的几个指令查看连接状态：

tcpdump

traceroute

ping

netstat

route

PING（Packet InterNet Groper）中文名为因特网包探索器，是用来查看网络上另一个主机系统的网络连接是否正常的一个工具。向XX机器发送ICMP包

ICMP

Internet Control Message Protocol ，网际控制报文协议，错误侦测与回报机制

%0A%E6%A6%82%E8%A7%88%0A\-\-\-%0A%E5%85%88%E7%9C%8B%E4%B8%80%E4%B8%8B%EF%BC%9AOSI%20TCP%2FIP4%20%E5%AF%B9%E6%AF%94%0A\!%5B7a1902e4bfdb3239ec140a4012f2970d.png%5D\(evernotecid%3A%2F%2FDA4CDA93\-C60D\-4423\-BC3E\-D9A1A033127A%2Fappyinxiangcom%2F35868219%2FENResource%2Fp92\)%0A%0A%3EOSI%E5%8F%82%E8%80%83%E6%A8%A1%E5%9E%8B%E7%9A%84%E8%BF%87%E4%BA%8E%E5%BA%9E%E5%A4%A7%E3%80%81%E5%A4%8D%E6%9D%82%E6%8B%9B%E8%87%B4%E4%BA%86%E8%AE%B8%E5%A4%9A%E6%89%B9%E8%AF%84%E3%80%82%0A%0A%0A%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BC%A0%E8%BE%93%E7%9A%84%E8%BF%87%E7%A8%8B%EF%BC%9A%E9%83%BD%E6%98%AF%E9%80%90%E5%B1%82%E5%90%91%E4%B8%8B%E5%A2%9E%E5%8A%A0%E6%8A%A5%E6%96%87%E5%A4%B4%0A\!%5B204912498d406e38ab40704c80ec2d1d.jpeg%5D\(evernotecid%3A%2F%2FDA4CDA93\-C60D\-4423\-BC3E\-D9A1A033127A%2Fappyinxiangcom%2F35868219%2FENResource%2Fp87\)%0A%3E%E5%9B%BE%E4%B8%8A%EF%BC%8C%E7%94%A8%E6%88%B7%E5%8F%91%E9%80%81%E4%B8%80%E6%AC%A1%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A4%A7%E6%A6%82%E8%BF%87%E7%A8%8B%E3%80%82%E7%BB%8F%E8%BF%87%E6%AF%8F%E5%B1%82%EF%BC%8C%E9%83%BD%E9%9C%80%E8%A6%81%E5%9C%A8%E5%8E%9F%E6%95%B0%E6%8D%AE%E5%89%8D%E9%9D%A2%E5%8A%A0%E4%B8%8A%E6%9C%AC%E5%B1%82%E7%9A%84%E4%BF%A1%E6%81%AF%E3%80%82%0A%0ATCP%2FIP%EF%BC%9A%E5%AE%9E%E9%99%85%E6%98%AF%E4%B8%8A%E4%B8%80%E7%BB%84%E5%8D%8F%E8%AE%AE%EF%BC%8C%E5%A4%A7%E4%BD%93%E4%B8%8A%E5%88%86%E4%B8%BA%EF%BC%9ATCP%E5%8D%8F%E8%AE%AE%2BIP%E5%8D%8F%E8%AE%AE%E7%BB%84%E6%88%90%0A%0ATCP%E5%8D%8F%E8%AE%AE%E8%B4%9F%E8%B4%A3%E7%9A%84%E6%98%AF%E6%9C%AC%E6%9C%BA%E6%95%B0%E6%8D%AE%E7%9A%84%E5%A4%84%E7%90%86%EF%BC%9A%E6%95%B0%E6%8D%AE%E6%8B%86%E5%88%86%E5%8C%85%E3%80%81%E4%BC%A0%E8%BE%93%E7%9A%84%E7%A8%B3%E5%AE%9A%E6%80%A7%E3%80%81%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84%E8%BF%9B%E7%A8%8B%E7%AD%89%EF%BC%8C%E8%80%8C%E7%BD%91%E7%BB%9C%E7%9A%84%E8%B7%AF%E7%94%B1%EF%BC%8C%E5%AF%B9%E7%AB%AF%E6%9C%BA%E5%99%A8%E7%9A%84%E5%AF%BB%E6%89%BE%EF%BC%8C%E8%BF%99%E4%BA%9B%E4%BA%A4%E7%BB%99IP%E5%B1%82%E6%9D%A5%E5%81%9A%EF%BC%8C%E6%9C%80%E5%90%8E%E5%8A%A0%E4%B8%8A%E7%89%A9%E7%90%86%E5%B1%82%E4%BC%A0%E8%BE%93%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%9F%BA%E6%9C%AC%E4%B8%8A%E5%B0%B1%E6%BB%A1%E8%B6%B3%E4%BA%86%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%0A%0A%0A%0A%0ATCP%0A\-\-\-\-%0Atransmission%20control%20protocol%20%EF%BC%8C%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE%0A%0ATCP\-%E6%95%B0%E6%8D%AE%E6%A0%BC%E5%BC%8F%EF%BC%9A%0A\!%5B56e62e4244a8f1b157f109f065172e22.png%5D\(evernotecid%3A%2F%2FDA4CDA93\-C60D\-4423\-BC3E\-D9A1A033127A%2Fappyinxiangcom%2F35868219%2FENResource%2Fp98\)%0A%0A%0A%0A%0A%0A1.%20%E6%BA%90%E7%AB%AF%E5%8F%A3%E5%8F%B7\(16%E4%BD%8D\)%20%0A%3E%E4%BB%8E%E4%B8%8A%E9%9D%A2%E7%9C%8B%E5%88%B0%E7%AB%AF%E5%8F%A3%E5%8F%B7%EF%BC%9A2%5E16%3D65535%E4%B8%AA%0A2.%20%E7%9B%AE%E5%BD%95%E7%AB%AF%E5%8F%A3%E5%8F%B7\(16%E4%BD%8D\)%0A3.%20%E5%88%9D%E5%A7%8B%E5%BA%8F%E5%8F%B7ISN\-%E9%A1%BA%E5%BA%8F%E5%8F%B7\(32%E4%BD%8D\)%0A4.%20%E7%A1%AE%E8%AE%A4%E5%BA%8F%E5%8F%B7\(32%E4%BD%8D\)%0A5.%20%E5%A4%B4%E9%83%A8%E9%95%BF%E5%BA%A6%2F%E6%95%B0%E6%8D%AE%E5%81%8F%E7%A7%BB\(4%E4%BD%8D\)%0A6.%20%E4%BF%9D%E7%95%99%20%20%0A6.%20%E6%A0%87%E5%BF%97%E4%BD%8D%EF%BC%8C6%E4%BD%8D%0A%20%20%20%201.%20URG%EF%BC%9A%E7%B4%A7%E6%80%A5%E6%8C%87%E9%92%88%0A%20%20%20%201.%20ACK\(Acknowledgement\)%3A%E7%A1%AE%E8%AE%A4%E5%BA%8F%E5%8F%B7%E6%9C%89%E6%95%88%0A%20%20%20%201.%20PSH%EF%BC%9A%E6%8E%A5%E6%94%B6%E6%96%B9%E5%BA%94%E8%AF%A5%E5%B0%BD%E5%BF%AB%E5%B0%86%E8%BF%99%E4%B8%AA%E6%8A%A5%E6%96%87%E6%AE%B5%E4%BA%A4%E7%BB%99%E5%BA%94%E7%94%A8%E5%B1%82%0A%20%20%20%201.%20RST%EF%BC%9A%E9%87%8D%E6%96%B0%E8%BF%9E%E6%8E%A5SYN%EF%BC%9A%E5%90%8C%E6%AD%A5%E5%BA%8F%E5%8F%B7%E7%94%A8%E6%9D%A5%E5%8F%91%E8%B5%B7%E4%B8%80%E4%B8%AA%E8%BF%9E%E6%8E%A5%0A%20%20%20%202.%20SYN%E8%A1%A8%E7%A4%BASYN%E6%8A%A5%E6%96%87%EF%BC%88%E5%9C%A8%E5%BB%BA%E7%AB%8BTCP%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%EF%BC%89%0A%20%20%20%201.%20FIN%EF%BC%9A%E5%8F%91%E7%AB%AF%E5%AE%8C%E6%88%90%E4%BB%BB%E5%8A%A1%0A7.%20%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F\(16%E4%BD%8D\)%0A8.%20%E6%A0%A1%E9%AA%8C%E5%92%8C\(16%E4%BD%8D\)%0A9.%20%E7%B4%A7%E6%80%A5%E6%8C%87%E9%92%88\(16%E4%BD%8D\)%0A10.%20%E5%8F%AF%E9%80%89%E9%A1%B9\(8%E7%9A%84%E6%95%B4%E6%95%B0%E5%80%8D\)%0A11.%20%E6%95%B0%E6%8D%AE%0A%0A%23%23%23%23%20%E5%88%86%E6%9E%90%0A%E7%9B%B8%E6%AF%94IP%E5%8D%8F%E8%AE%AE%EF%BC%8CTCP%E5%8F%AF%E8%A6%81%E5%A4%8D%E6%9D%82%E4%B8%8D%E5%B0%91%0A1.%20%E8%BF%9E%E6%8E%A5%E6%9C%BA%E5%88%B6%EF%BC%9A%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%EF%BC%8C%E6%96%AD%E5%BC%80%E8%BF%9E%E6%8E%A5%0A%3E%E7%A1%AE%E8%AE%A4%E5%8F%B7%E3%80%81%E9%A1%BA%E5%BA%8F%E5%8F%B7%E3%80%81%E8%BF%9E%E6%8E%A5%E6%A0%87%E5%BF%97%0A2.%20%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3%E6%9C%BA%E5%88%B6\(%E4%BF%9D%E8%AF%81%E5%8F%AF%E9%9D%A0%E4%BC%A0%E8%BE%93%EF%BC%8C%E5%B9%B6%E4%B8%94%E6%9C%89%E9%A1%BA%E5%BA%8F%E6%80%A7\)%0A%0A%3E%E5%8F%A6%E5%A4%96%E6%88%91%E4%BB%AC%E7%9C%8B%E5%88%B0%EF%BC%8CTCP%E9%87%8C%E6%B2%A1%E6%9C%89IP%E5%9C%B0%E5%9D%80%E4%BF%A1%E6%81%AF%EF%BC%8CTCP%E5%B9%B6%E4%B8%8D%E6%98%AF%E5%85%B3%E5%BF%83%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9A%84%E4%BA%8B%E6%83%85%EF%BC%8C%E6%9B%B4%E5%85%B3%E5%BF%83%3A%E6%95%B0%E6%8D%AE%E7%9A%84%E4%BC%A0%E8%BE%93%EF%BC%8C%E7%AB%AF%E5%8F%A3%E6%98%A0%E5%B0%84%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%9B%B8%E5%85%B3%E4%BA%8B%E6%83%85%0A%0A%0ATCP%E5%88%9B%E5%BB%BA%E8%BF%9E%E6%8E%A5%0A\-\-\-\-\-%0A\!%5B2eca41afaa8046f1338b0998ccb0582c.png%5D\(evernotecid%3A%2F%2FDA4CDA93\-C60D\-4423\-BC3E\-D9A1A033127A%2Fappyinxiangcom%2F35868219%2FENResource%2Fp99\)%0A%0A%23%23%23%23%20%E5%9F%BA%E7%A1%80%E6%9C%AF%E8%AF%AD%0A%0A%E9%A1%BA%E5%BA%8F%E5%8F%B7\(sn\)%3A32%E4%BD%8D\-%E6%AD%A3%E6%95%B4%E6%95%B0\(0~4294967294\)%0A%E7%A1%AE%E8%AE%A4%E5%8F%B7\(ack\)%3A%E6%8E%A5%E6%94%B6%E6%96%B9%EF%BC%8C%E6%8A%8A%E5%8F%91%E9%80%81%E6%96%B9%E5%8F%91%E6%9D%A5%E7%9A%84%E9%A1%BA%E5%BA%8F%E5%8F%B7%2B1%0A%0Ax%EF%BC%9A%E4%BB%BB%E6%84%8F%E4%B8%80%E4%B8%AA%E8%87%AA%E7%84%B6%E6%95%B4%E6%95%B0%EF%BC%8C%E7%94%B1%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%B3%BB%E7%BB%9F%E7%94%9F%E6%88%90%EF%BC%8C%E4%B9%9F%E6%98%AFsn%E5%8F%B7%0Ay%EF%BC%9A%E4%BB%BB%E6%84%8F%E4%B8%80%E4%B8%AA%E8%87%AA%E7%84%B6%E6%95%B4%E6%95%B0%EF%BC%8C%E7%94%B1%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%B3%BB%E7%BB%9F%E7%94%9F%E6%88%90%EF%BC%8C%E4%B9%9F%E6%98%AFsn%E5%8F%B7%0A%0A%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%8A%B6%E6%80%81%EF%BC%9A%0A1.%20SYN\_SENT%EF%BC%9A%E8%AF%B7%E6%B1%82%E8%BF%9E%E6%8E%A5%E7%8A%B6%E6%80%81%0A2.%20ESTABLISHED%EF%BC%9A%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F%0A3.%20CLOSED%EF%BC%9A%E8%BF%9E%E6%8E%A5%E5%85%B3%E9%97%AD%0A%0A%E6%9C%8D%E5%8A%A1%E7%AB%AF%E7%8A%B6%E6%80%81%EF%BC%9A%0A1.%20LISTENING%EF%BC%9A%E7%9B%91%E5%90%AC%E7%8A%B6%E6%80%81%0A2.%20SYN\-RCVD%E7%8A%B6%E6%80%81%3A%E6%94%B6%E5%88%B0%E5%92%8C%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AA%E8%BF%9E%E6%8E%A5%E8%AF%B7%E6%B1%82%E5%90%8E%E7%AD%89%E5%BE%85%E5%AF%B9%E6%96%B9%E5%AF%B9%E8%BF%9E%E6%8E%A5%E8%AF%B7%E6%B1%82%E7%9A%84%E7%A1%AE%E8%AE%A4%0A3.%20ESTABLISHED%E7%8A%B6%E6%80%81%3A%E8%BF%9E%E6%8E%A5%E6%88%90%E5%8A%9F%0A%0A%0A%0A%0A%23%23%23%23%20%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%0A%E7%AC%AC%E4%B8%80%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9A%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%8F%91%E9%80%81%E5%8C%85\(%E5%A4%B4\)%2C%20flags%20%E5%AD%97%E6%AE%B5%E4%B8%AD%E7%9A%84%20SYN%3D1%20%EF%BC%8C%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E6%95%B0%3Ax%EF%BC%8Csn%3Dx%2C%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%EF%BC%8C%E5%B9%B6%E8%BF%9B%E5%85%A5SYN\_SEND%E7%8A%B6%E6%80%81%EF%BC%8C%E7%AD%89%E5%BE%85%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AE%E8%AE%A4%0A%E7%AC%AC%E4%BA%8C%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9A%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%94%B6%E5%88%B0%E5%8C%85\(%E5%A4%B4\)%2C%EF%BC%8C%E5%88%A4%E6%96%AD%20SYN%3D1%EF%BC%8C%E6%98%AF%E8%A6%81%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%EF%BC%8C%E4%BA%8E%E6%98%AF%EF%BC%8C%E8%BF%94%E5%9B%9E%E5%8C%85\(%E5%A4%B4\)%EF%BC%9A%E9%9A%8F%E6%9C%BA%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E6%95%B0y%2C%20SYN%3D1%2CACK%3D1%2Csn%3Dy%2Cack%3DX%2B1%EF%BC%8C%E6%AD%A4%E6%97%B6%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E5%85%A5SYN\_RECV%E7%8A%B6%E6%80%81%0A%E7%AC%AC%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9A%E6%94%B6%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%8C%85\(%E5%A4%B4\)%EF%BC%9A%E5%88%A4%E6%96%AD%20SYN%3D1%EF%BC%8CACK%3D1%EF%BC%8C%E8%BF%99%E6%98%AF%E7%A1%AE%E8%AE%A4%E8%BF%9E%E6%8E%A5%EF%BC%8C%E7%84%B6%E5%90%8E%EF%BC%8C%E5%90%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%91%E9%80%81%E7%A1%AE%E8%AE%A4%E5%8C%85%E5%A4%B4%EF%BC%9AACK%3D1%EF%BC%8Csn%3Dx%2B1%E3%80%81ack%3Dy%2B1\)%EF%BC%8C%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9B%E5%85%A5%20ESTABLISHED%20%E7%8A%B6%E6%80%81%0A%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%8E%A5%E6%94%B6%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84%E7%A1%AE%E8%AE%A4%E4%BF%A1%E6%81%AF%E5%90%8E%EF%BC%8C%E8%BF%9B%E5%85%A5%20ESTABLISHED%20%E7%8A%B6%E6%80%81%20%E5%AE%8C%E6%88%90%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E3%80%82%0A%0A%3E%E7%9C%8B%E7%9D%80%E6%98%AF3%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%A4%E7%AB%AF%E8%A6%81%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91%E5%85%B6%E5%AE%9E%E5%85%B1%E8%AE%A1%E6%98%AF4%E6%AC%A1%EF%BC%8C3%E6%AC%A1%E6%9B%B4%E5%A4%9A%E7%9A%84%E6%98%AF%E6%8C%87%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E8%B5%B0%E4%BA%863%E6%AC%A1%E8%80%8C%E5%B7%B2%0A%0A%E6%95%B4%E4%B8%AA%E8%BF%87%E7%A8%8B%EF%BC%9A%E5%8F%AA%E9%9C%80%E8%A6%81%E5%A4%84%E7%90%86%E5%A4%B4%E4%BF%A1%E6%81%AF%E5%8D%B3%E5%8F%AF%EF%BC%8C%E5%8C%85%E9%87%8C%E5%B9%B6%E6%B2%A1%E6%9C%89%E4%BB%BB%E4%BD%95%E6%95%B0%E6%8D%AE%E3%80%82%E4%B8%A4%E7%AB%AF%E5%90%84%E7%94%9F%E6%88%90%E4%B8%80%E4%B8%AA%E9%9A%8F%E6%9C%BA%E6%95%B0%EF%BC%8C%E4%BB%A5%E7%A1%AE%E4%BF%9D%E6%98%AF%E5%AE%89%E5%85%A8%E7%9A%84%E8%BF%9E%E6%8E%A5%0A%0A%0A%0A%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE%0A%0A%E5%BD%93%E8%BF%9E%E6%8E%A5%E9%82%A3%E4%B8%8A%E6%88%90%E5%8A%9F%E5%90%8E%E5%B0%B1%E8%A6%81%E5%8F%91%E9%80%81%E6%95%B0%E6%8D%AE%E4%BA%86%EF%BC%8C%E6%AD%A3%E5%B8%B8%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E6%AE%B5%EF%BC%8C%E5%8F%AF%E8%83%BD%E5%BE%88%E9%95%BF%EF%BC%8C%E4%B9%9F%E5%8F%AF%E8%83%BD%E5%BE%88%E7%9F%AD%E3%80%82%E6%8B%BF%E6%AF%94%E8%BE%83%E9%95%BF%E7%9A%84%E6%9D%A5%E8%AF%B4%EF%BC%8C%E6%95%B0%E6%8D%AE%E5%85%88%E4%BC%9A%E8%A2%AB%E5%86%99%E5%88%B0%E7%BC%93%E5%86%B2%E5%8C%BA%EF%BC%8C%E7%84%B6%E5%90%8E%E6%89%93%E5%8C%85%E6%88%90TCP%E6%8A%A5%E6%96%87%E6%AE%B5%EF%BC%8C%E7%9B%B4%E5%88%B0%E6%9C%80%E5%90%8E%E4%B8%80%E6%AE%B5%E6%95%B0%E6%8D%AE%E8%BF%9B%E6%9D%A5%EF%BC%8C%E5%86%8D%E6%AC%A1%E8%BF%9B%E8%A1%8C%E6%89%93%E5%8C%85%EF%BC%8C%E7%84%B6%E5%90%8E%E5%8A%A0%E6%AD%A4%E6%8A%A5%E6%96%87%E7%9A%84flags%E4%B8%AD%E7%9A%84psh%E7%BD%AE%E6%88%901%EF%BC%8Cack%E8%AE%BE%E7%BD%AE%E6%88%901%EF%BC%8C%E7%BB%9F%E4%B8%80%E5%8F%91%E9%80%81%E5%87%BA%E5%8E%BB%E3%80%82%0A%0A%E6%8E%A5%E6%94%B6%E6%96%B9%EF%BC%8C%E4%BC%9A%E6%8A%8A%E6%8A%A5%E6%96%87%EF%BC%8C%E4%BE%9D%E6%AC%A1%E6%94%BE%E5%85%A5%E5%88%B0%20%E8%AF%BB%EF%BC%8C%E7%BC%93%E5%86%B2%E5%8C%BA%E3%80%82%E5%A6%82%E6%9E%9C%E5%85%A8%E9%83%A8%E6%94%B6%E5%85%A8%E4%B8%94%E5%8F%91%E7%8E%B0%E6%9C%89psh%E6%A0%87%E8%AF%86%2C%E5%88%99%E7%AB%8B%E5%88%BB%E9%80%9A%E7%9F%A5%E5%BA%94%E7%94%A8%E5%B1%82%E8%BF%9B%E7%A8%8B%EF%BC%8C%E6%9D%A5%E6%8B%BF%E6%95%B0%E6%8D%AE%E3%80%82%E5%86%8D%E8%BF%94%E5%9B%9E%E7%BB%99%E5%8F%91%E9%80%81%E6%96%B9%E4%B8%80%E4%B8%AAACK~%E4%B9%8B%E5%90%8E%E3%80%82%0A%0A%E8%BF%99%E9%87%8C%EF%BC%8C%E5%A6%82%E6%9E%9C%E4%BF%9D%E8%AF%81%E5%8F%91%E9%80%81%E6%96%B9%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E6%8E%A5%E6%94%B6%E6%96%B9%E9%83%BD%E8%83%BD%E5%A4%9F%E6%8E%A5%E5%85%A8%E3%80%82%E5%B0%B1%E7%89%B5%E6%89%AF%E5%88%B0%20%E7%AA%97%E5%8F%A3%E6%BB%91%E5%8A%A8%E6%9C%BA%E5%88%B6%E4%BA%86%E3%80%82%0A%0ATCP%E5%85%B3%E9%97%AD%E8%BF%9E%E6%8E%A5%0A\-\-\-\-%0A%3E%E7%BB%93%E5%90%88%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%9B%BE%0A%0A4%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%9A%0A1.%20A%E5%8F%91%E4%BA%86%E5%85%B3%E9%97%AD%E8%AF%B7%E6%B1%82%20\(FIN%3D1%E3%80%81seq%3Dx%E3%80%81ack%3Dz\)%EF%BC%8C%E7%8A%B6%E6%80%81%E5%8F%98%E6%88%90%EF%BC%9Afin\_wait\_1%E7%8A%B6%E6%80%81%0A2.%20B%E6%8E%A5%E6%94%B6%E5%88%B0%EF%BC%8C%E5%88%A4%E6%96%AD%E6%A0%87%E8%AF%86%E4%BD%8DFIN%3D1\(seq%3Dz%E3%80%81ack%3Dx%2B1\)%E5%85%B3%E9%97%AD%E4%BA%86%E5%85%B6%E4%B8%AD%E4%B8%80%E4%B8%AA%E9%80%9A%E8%B7%AF%EF%BC%8C%E7%84%B6%E5%90%8E%E7%BB%99A%E5%8F%91%E8%B5%B7%E4%B8%80%E4%B8%AAACK%0A3.%20A%E6%8E%A5%E6%94%B6ACK%E7%A1%AE%E8%AE%A4%E6%AD%A4%E6%9D%A1%E7%BA%BF%E8%B7%AF%E8%A2%AB%E5%85%B3%E9%97%AD%EF%BC%8C%E7%8A%B6%E6%80%81%E5%88%87%E6%8D%A2%E5%88%B0%20fin\_wait\_2%E7%8A%B6%E6%80%81.B%E5%86%8D%E5%8F%91%E5%87%BA%E5%85%B3%E9%97%AD%E8%AF%B7%E6%B1%82FIN%EF%BC%8C%E8%BF%9B%E5%85%A5last\_ack%E7%8A%B6%E6%80%81%0A4.%20A%E6%94%B6%E5%88%B0%E5%85%B3%E9%97%ADADK%E8%AF%B7%E6%B1%82%EF%BC%8C%E7%84%B6%E5%90%8E%E5%86%8D%E7%BB%99A%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AAACK%EF%BC%8C%E8%BF%9B%E5%85%A5time\_wait%20%E7%8A%B6%E6%80%81%0A%3EA%E7%BB%8F%E8%BF%872%E4%B8%AAMSL%E5%90%8E%EF%BC%8C%E8%87%AA%E5%8A%A8%E5%85%B3%E9%97%AD%E6%AD%A4%E6%9D%A1%E8%BF%9E%E6%8E%A5%0A%0A%E6%9C%80%E5%90%8E%EF%BC%8CB%E6%8E%A5%E6%94%B6%E5%88%B0%EF%BC%8C%E5%88%A4%E6%96%AD%E6%A0%87%E8%AF%86%E4%BD%8DFIN%3D1\(seq%3Dx%E3%80%81ack%3Dy\)%E5%86%8D%E5%85%B3%E9%97%AD%E4%B8%80%E6%9D%A1%E9%80%9A%E9%81%93%EF%BC%8C%E5%88%B0%E6%AD%A4%E5%85%A8%E5%85%B3%E9%97%AD%E4%BA%86%0A%0AMSL%E6%98%AFMaximum%20Segment%20Lifetime%E7%9A%84%E8%8B%B1%E6%96%87%E7%BC%A9%E5%86%99%EF%BC%8C%E5%8F%AF%E8%AF%91%E4%B8%BA%E2%80%9C%E6%9C%80%E9%95%BF%E6%8A%A5%E6%96%87%E6%AE%B5%E5%AF%BF%E5%91%BD%E2%80%9D%EF%BC%8C%E5%AE%83%E6%98%AF%E4%BB%BB%E4%BD%95%E6%8A%A5%E6%96%87%E5%9C%A8%E7%BD%91%E7%BB%9C%E4%B8%8A%E5%AD%98%E5%9C%A8%E7%9A%84%E6%9C%80%E9%95%BF%E7%9A%84%E6%9C%80%E9%95%BF%E6%97%B6%E9%97%B4%EF%BC%8C%E8%B6%85%E8%BF%87%E8%BF%99%E4%B8%AA%E6%97%B6%E9%97%B4%E6%8A%A5%E6%96%87%E5%B0%86%E8%A2%AB%E4%B8%A2%E5%BC%83%E3%80%82%0A%0ATCP%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%BC%8F%E6%B4%9E%0A\-\-\-\-%0A%23%23%23%23%20%E5%8D%8A%E8%BF%9E%E6%8E%A5%0A%E5%BD%93%E6%9C%8D%E5%8A%A1%E7%AB%AF%E6%8E%A5%E6%94%B6%E5%88%B0C%E7%AB%AF%E7%9A%84%E8%BF%9E%E6%8E%A5%E8%AF%B7%E6%B1%82%E5%90%8E%EF%BC%8C%E4%BC%9A%E5%8F%91%E5%8C%85%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BF%9B%E5%85%A5%20SYN\-RCVD%20%E7%8A%B6%E6%80%81%EF%BC%8C%E8%80%8C%E5%A6%82%E6%9E%9C%E8%BF%9F%E8%BF%9F%E7%AD%89%E4%B8%8D%E5%88%B0C%E7%AB%AF%E7%9A%84%E7%AC%AC%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E8%AF%B7%E6%B1%82%EF%BC%8C%E5%B0%B1%E4%BC%9A%E4%BA%A7%E7%94%9F%E4%B8%80%E5%A0%86%E7%9A%84%E5%8D%8A%E8%BF%9E%E6%8E%A5%0A%E6%9C%AA%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97%EF%BC%9A%E5%9C%A8%E4%B8%89%E6%AC%A1%E6%8F%A1%E6%89%8B%E5%8D%8F%E8%AE%AE%E4%B8%AD%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%BB%B4%E6%8A%A4%E4%B8%80%E4%B8%AA%E6%9C%AA%E8%BF%9E%E6%8E%A5%E9%98%9F%E5%88%97%EF%BC%8C%E8%AF%A5%E9%98%9F%E5%88%97%E4%B8%BA%E6%AF%8F%E4%B8%AA%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9A%84SYN%E5%8C%85%EF%BC%88syn%3Dj%EF%BC%89%E5%BC%80%E8%AE%BE%E4%B8%80%E4%B8%AA%E6%9D%A1%E7%9B%AE%EF%BC%8C%E8%AF%A5%E6%9D%A1%E7%9B%AE%E8%A1%A8%E6%98%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%B7%B2%E6%94%B6%E5%88%B0SYN%20%E5%8C%85%EF%BC%8C%E5%B9%B6%E5%90%91%E5%AE%A2%E6%88%B7%E5%8F%91%E5%87%BA%E7%A1%AE%E8%AE%A4%EF%BC%8C%E6%AD%A3%E5%9C%A8%E7%AD%89%E5%BE%85%E5%AE%A2%E6%88%B7%E7%9A%84%E7%A1%AE%E8%AE%A4%E5%8C%85%E3%80%82%0A%E8%BF%99%E4%BA%9B%E6%9D%A1%E7%9B%AE%E6%89%80%E6%A0%87%E8%AF%86%E7%9A%84%E8%BF%9E%E6%8E%A5%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%84%E4%BA%8E%20Syn\_RECV%20%E7%8A%B6%E6%80%81%EF%BC%8C%E5%BD%93%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%94%B6%E5%88%B0%E5%AE%A2%E6%88%B7%E7%9A%84%E7%A1%AE%E8%AE%A4%E5%8C%85%E6%97%B6%EF%BC%8C%E5%88%A0%E9%99%A4%E8%AF%A5%E6%9D%A1%E7%9B%AE%EF%BC%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%9B%E5%85%A5ESTABLISHED%E7%8A%B6%E6%80%81%E3%80%82%0A%0A%23%23%23%23%20time\-wait%0A%E5%9C%A8%E9%AB%98%E5%B9%B6%E5%8F%91%E6%83%85%E4%B8%94%E7%9F%AD%E8%BF%9E%E6%8E%A5%E6%83%85%E5%86%B5%E4%B8%8B%EF%BC%8C%E5%A6%82%EF%BC%9AHTTP%E5%8D%8F%E8%AE%AE%EF%BC%8C%E6%9C%8D%E5%8A%A1%E7%AB%AF%E5%A4%A7%E5%A4%9A%E4%BC%9A%E4%B8%BB%E5%8A%A8%E6%96%AD%E5%BC%80TCP%E8%BF%9E%E6%8E%A5%EF%BC%8C%E9%82%A3%E4%B9%88%EF%BC%8C%E5%9C%A8timewait%E7%8A%B6%E6%80%81%E4%B8%8B%EF%BC%8C%E8%A6%81%E7%AD%89%E5%BE%852msl%E7%9A%84%E6%97%B6%E9%97%B4%EF%BC%8C%E8%BF%99%E4%BC%9A%E9%80%A0%E6%88%90socket%E6%95%B0%E9%87%8F%E4%B8%8D%E5%A4%9F%E7%94%A8%0A%0ATCP%E7%AA%97%E5%8F%A3%E6%BB%91%E5%8A%A8%0A\-\-\-\-\-%0A%0A%E5%BD%93%E8%BF%9B%E7%A8%8B%EF%BC%8C%E5%B0%86%E8%A6%81%E5%8F%91%E9%80%81%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%8F%91%E9%80%81%E5%88%B0%E7%BC%93%E5%86%B2%E5%8C%BA%E5%90%8E~%E8%AF%A5%E5%8C%BA%E5%9F%9F%E5%B0%B1%E6%8A%8A%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E6%89%93%E4%B8%8A4%E7%A7%8D%E6%A0%87%E8%AF%86%0A1%E3%80%81%E5%B7%B2%E5%8F%91%E9%80%81%E5%B9%B6%E7%A1%AE%E8%AE%A4%E8%BF%87%E7%9A%84%E6%95%B0%E6%8D%AE%0A2%E3%80%81%E5%B7%B2%E5%8F%91%E9%80%81%E6%9C%AA%E7%A1%AE%E8%AE%A4%E8%BF%87%E7%9A%84%E6%95%B0%E6%8D%AE%0A3%E3%80%81%E6%8E%A5%E4%B8%8B%E6%9D%A5%EF%BC%8C%E5%8D%B3%E5%B0%86%E8%A6%81%E5%8F%91%E9%80%81%E7%9A%84%E6%95%B0%E6%8D%AE%0A4%E3%80%81%E6%9C%AA%E5%8F%91%E9%80%81%E7%9A%84%E6%95%B0%E6%8D%AE%0A%E5%AE%9E%E9%99%85%E4%B8%8A%EF%BC%8C2%E3%80%813%E6%AD%A5%E9%AA%A4%EF%BC%8C%E4%BC%9A%E8%A2%AB%E4%B8%80%E4%B8%AA%20%E8%99%9A%E6%8B%9F%E7%9A%84%20%E7%AA%97%E5%8F%A3%E8%A6%86%E7%9B%96%E4%B8%8A~%E5%BD%932%E6%AD%A5%E6%95%B0%E6%8D%AE%E7%BB%8F%E8%BF%87%E7%A1%AE%E8%AE%A4%E5%90%8E%EF%BC%8C%E7%AA%97%E5%8F%A3%E8%87%AA%E5%8A%A8%E5%90%91%E5%8F%B3%E6%BB%91%E5%8A%A8%E3%80%82%0A%0A%0AUDP%0A\-\-\-\-%0Auser%20data%20protocol%20%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8D%8F%E8%AE%AE%E4%B8%8D%E5%8F%AF%E9%9D%A0%E7%9A%84%E3%80%81%E6%97%A0%E8%BF%9E%E6%8E%A5%E7%9A%84%E6%95%B0%E6%8D%AE%E6%8A%A5%E6%9C%8D%E5%8A%A1%EF%BC%8C%E5%AE%9E%E9%99%85%E6%9B%B4%E6%B7%B1%E5%85%A5%E7%9A%84%E4%BA%86%E8%A7%A3%E6%98%AF%EF%BC%9A%E6%B2%A1%E6%9C%89%E8%BF%9B%E8%A1%8C3%E6%AC%A1%E6%8F%A1%E6%89%8B%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%B2%A1%E6%9C%89%E6%A0%A1%E9%AA%8C%E7%9A%84%E8%BF%87%E7%A8%8B%EF%BC%8C%E7%9B%B4%E6%8E%A5%E5%B0%86%E6%8A%A5%E6%96%87%E5%A4%B4%2B%E6%95%B0%E6%8D%AE%EF%BC%8C%E5%8F%91%E9%80%81%E7%BB%99%E7%9B%AE%E7%9A%84%E4%B8%BB%E6%9C%BA%E3%80%82\!%5Ba970d7b1a3a591f2dfcb35413cb914ae.jpeg%5D\(evernotecid%3A%2F%2FDA4CDA93\-C60D\-4423\-BC3E\-D9A1A033127A%2Fappyinxiangcom%2F35868219%2FENResource%2Fp91\)%0A%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8A%EF%BC%8C%E5%AE%9E%E9%99%85%E4%B8%8A%E4%B8%AA%E4%BA%BA%E7%9A%84%E7%90%86%E8%A7%A3%E6%98%AF%EF%BC%9AIP%E5%A4%84%E7%90%86%E7%9A%84%E6%98%AF%E4%B8%BB%E6%9C%BA%E5%88%B0%E4%B8%BB%E6%9C%BA%E7%9A%84%E9%80%9A%E4%BF%A1%EF%BC%8C%E8%80%8CTCP%E5%A4%84%E7%90%86%E7%9A%84%E6%98%AF%E4%B8%80%E5%8F%B0%E6%9C%BA%E5%99%A8%E4%B8%8A%E7%AB%AF%E5%8F%A3%E5%88%B0%E7%AB%AF%E5%8F%A3%E7%9A%84%E9%80%9A%E4%BF%A1%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E8%BF%9B%E7%A8%8B%E4%B9%8B%E9%97%B4%E7%9A%84%E9%80%9A%E4%BF%A1%E3%80%82%0A%E6%9C%80%E5%88%9D%EF%BC%8C%E4%B8%BA%E4%BA%86%E5%AE%9E%E7%8E%B0%E5%87%A0%E5%8F%B0%EF%BC%8C%E6%88%96%E8%80%85%E4%B8%80%E6%A0%8B%E6%A5%BC%E9%87%8C%E7%9A%84%E6%9C%BA%E5%99%A8%E4%BA%92%E8%81%94%EF%BC%8C%E5%B0%B1%E4%BA%A7%E7%94%9F%E4%BA%86IP%E8%B7%AF%E7%94%B1%E5%99%A8%EF%BC%8C%E4%B9%9F%E5%B0%B1%E6%98%AF%E7%BD%91%E5%85%B3%0A%0A%0AMSS%0A\-\-\-%0AMaximum%20Segment%20Size%EF%BC%9A%E6%9C%80%E5%A4%A7%E6%8A%A5%E6%96%87%E6%AE%B5%EF%BC%8C%E6%98%AFTCP%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%B8%80%E4%B8%AA%E9%80%89%E9%A1%B9%E3%80%82%0AMSS%E9%80%89%E9%A1%B9%E7%94%A8%E4%BA%8E%E5%9C%A8TCP%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%E6%97%B6%EF%BC%8C%E6%94%B6%E5%8F%91%E5%8F%8C%E6%96%B9%E5%8D%8F%E5%95%86%E4%B8%80%E4%B8%AATCP%E6%8A%A5%E6%96%87%E6%AE%B5%E6%89%80%E8%83%BD%E6%89%BF%E8%BD%BD%E7%9A%84%E6%9C%80%E5%A4%A7%E6%95%B0%E6%8D%AE%E9%95%BF%E5%BA%A6%E3%80%82MSS%E9%80%89%E9%A1%B9%E5%8F%AA%E5%9C%A8%E5%88%9D%E5%A7%8B%E5%8C%96%E8%BF%9E%E6%8E%A5%E8%AF%B7%E6%B1%82\(SYN%3D1\)%E7%9A%84%E6%8A%A5%E6%96%87%E6%AE%B5%E4%B8%AD%E4%BD%BF%E7%94%A8%E3%80%82%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84MSS%E5%BE%88%E9%87%8D%E8%A6%81%E3%80%82%E5%A6%82%E6%9E%9CMSS%E5%B0%8F%E4%BA%86%EF%BC%8C%E7%BD%91%E7%BB%9C%E5%88%A9%E7%94%A8%E7%8E%87%E4%BD%8E%E3%80%82%E5%A6%82%E6%9E%9CMSS%E5%A4%A7%E4%BA%86%EF%BC%8C%E7%94%B1%E4%BA%8E%E5%9C%A8%E7%BD%91%E7%BB%9C%E5%B1%82%E9%9C%80%E8%A6%81%E5%88%86%E7%89%87%EF%BC%8C%E4%B9%9F%E4%BC%9A%E5%BD%B1%E5%93%8D%E7%BD%91%E7%BB%9C%E6%80%A7%E8%83%BD%E3%80%82%E4%B8%80%E8%88%ACMSS%E7%9A%84%E9%95%BF%E5%BA%A6%E4%B8%BAMTU\(1500\)\-IP%E9%A6%96%E9%83%A8\(20\)\-TCP%E9%A6%96%E9%83%A8\(20\)%3D1460%E5%AD%97%E8%8A%82%E3%80%82%0A%0A%0A5%E5%85%83%E7%BB%84%0A%E4%B8%80%E4%B8%AA%E6%96%B0%E8%BF%9E%E6%8E%A5%EF%BC%8C%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%EF%BC%8C%E6%98%AF%E4%B8%80%E4%B8%AASOCK%EF%BC%8CFD%E3%80%82%E4%B9%9F%E5%B0%B1%E6%98%AF%E6%98%AF%E4%B8%80%E4%B8%AA%E8%BF%9E%E6%8E%A5%E6%96%87%E4%BB%B6%EF%BC%8C%E8%AF%A5%E6%96%87%E4%BB%B6%E7%9A%84%E6%A0%87%E8%AF%86%EF%BC%9A%E6%BA%90IP%2B%E6%BA%90%E7%AB%AF%E5%8F%A3%2BTCP%2FUDP%2B%E7%9B%AE%E6%A0%87IP%2B%E7%9B%AE%E6%A0%87%E7%AB%AF%E5%8F%A3%0A%0A%0Akeepalive%0A\-\-\-\-\-%0Akeepalive%3A%E4%BF%9D%E6%B4%BB%E6%9C%BA%E5%88%B6%E3%80%82%0A%E6%8B%BFlinux%20socket%E6%9D%A5%E8%AF%B4%EF%BC%8C%E8%99%BD%E7%84%B6%E5%90%84%E7%A7%8D%E4%B9%A6%E7%B1%8D%E6%96%87%E6%A1%A3%E9%83%BD%E8%AF%B4%E7%BD%91%E7%BB%9C%E8%A6%81%E5%BB%BA%E7%AB%8B%E8%BF%9E%E6%8E%A5%EF%BC%8C%E8%80%8C%E8%BF%99%E4%B8%AA'%E8%BF%9E%E6%8E%A5'%E5%B9%B6%E4%B8%8D%E6%98%AF%E7%9C%9F%E5%AE%9E%E6%9C%89%E4%B8%AA%E9%93%BE%E6%8E%A5%EF%BC%8C%E9%81%93%E7%90%86%E5%BE%88%E7%AE%80%E5%8D%95%EF%BC%9A%E7%9C%9F%E8%A6%81%E6%98%AF%E6%9C%89%E6%A0%B9%E7%89%A9%E7%90%86%E7%9A%84%E7%BD%91%E5%BC%A0%E5%88%9B%E5%BB%BA%E8%BF%9E%E6%8E%A5%EF%BC%8C%E9%82%A3%E4%B8%80%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%BE%97%E6%9C%89%E5%A4%9A%E5%B0%91%E6%9D%A1%E8%BF%99%E6%A0%B7%E7%9A%84%E7%BD%91%E7%BA%BF%EF%BC%9F%E4%B8%8D%E7%8E%B0%E5%AE%9E%E3%80%82%0A%E5%AE%9E%E9%99%85%E5%B0%B1%E6%98%AF%EF%BC%9A%E5%8F%8C%E6%96%B9%E5%81%9A%E4%B8%AA%E9%AA%8C%E8%AF%81%EF%BC%8C%E7%95%99%E4%B8%AATOKEN%E4%B9%8B%E7%B1%BB%E7%9A%84%EF%BC%8C%E5%86%8D%E7%94%B1OS%E6%8E%A5%E7%AE%A1%EF%BC%8C%E5%BC%842%E4%B8%AAsocket%20FD%EF%BC%8C%E8%80%8C%E5%B7%B2%E3%80%82%0A%E9%82%A3%E4%B9%88%EF%BC%8C%E8%BF%99%E6%9D%A1%E8%99%9A%E6%8B%9F%E7%9A%84%E8%BF%9E%E6%8E%A5%EF%BC%8C%E5%A6%82%E6%9E%9C%E5%8F%8C%E6%96%B9%E4%B8%8D%E6%B6%88%E6%81%AF%EF%BC%8C%E5%8F%8C%E6%96%B9%E5%8F%88%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E5%AF%B9%E6%96%B9%E6%98%AF%E5%90%A6%E8%BF%98%E5%9C%A8%E7%BA%BF%E5%91%A2%EF%BC%9F%0AFIN%E8%BF%99%E7%A7%8D%E5%85%B3%E9%97%AD%E6%98%AF%E6%9C%89%E5%BE%88%E5%A4%9A%E9%97%AE%E9%A2%98%E7%9A%84%EF%BC%8C%E5%A6%82%EF%BC%9A%0A1.%20%E5%AF%B9%E6%96%B9%E8%BF%9B%E7%A8%8B%E6%8C%82%E4%BA%86%EF%BC%8COS%E7%9B%B4%E6%8E%A5%E6%97%A0%E8%A7%86%EF%BC%8C%E6%A0%B9%E6%9C%AC%E6%B2%A1%E6%9D%A5%E5%BE%97%E5%8F%8A%E5%8F%91FIN%EF%BC%8C%0A2.%20%E6%9F%90%E4%B8%80%E6%96%B9%E7%BD%91%E7%BB%9C%E5%87%BA%E4%BA%86%E9%97%AE%E9%A2%98%EF%BC%8C%E4%B9%9F%E5%8F%91%E4%B8%8D%E5%87%BA%E5%8E%BBFIN%0A3.%20%E6%9F%90%E6%96%B9CPU%E8%AE%A1%E7%AE%97%E9%87%8F%E9%9D%9E%E5%B8%B8%E5%A4%A7%EF%BC%8C%E8%80%8C%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E6%8B%BF%E4%B8%8D%E5%88%B0CPU%E8%B5%84%E6%BA%90%EF%BC%8C%E5%8F%AA%E8%83%BD%E7%AD%89%E5%BE%85%E3%80%82%0A4.%20%E4%B8%A2%E5%8C%85%0A....%0A%3E%E5%8F%91%E4%B8%8D%E5%87%BA%E5%8E%BBFIN%E7%9A%84%E6%83%85%E5%86%B5%E5%85%B6%E5%AE%9E%E5%BE%88%E5%A4%9A%E7%9A%84......%0A%0Aheaderbeat%EF%BC%9A%E5%BF%83%E8%B7%B3%E6%9C%BA%E5%88%B6%EF%BC%8C%E5%AF%B9%E4%BA%8E%E4%B8%8A%E9%9D%A2%E8%AF%B4%E7%9A%84%E4%B8%A4%E7%AB%AF%E5%A6%82%E4%BD%95%E7%9F%A5%E9%81%93%E5%AF%B9%E6%96%B9%E5%9C%A8%E7%BA%BF%EF%BC%9F%E5%85%B6%E5%AE%9E%E4%B9%9F%E6%B2%A1%E6%9C%89%E5%A4%AA%E5%A5%BD%E7%9A%84%E5%8A%9E%E6%B3%95%EF%BC%8C%E5%BC%82%E5%B8%B8%E5%A4%AA%E5%A4%9A%EF%BC%8C%E4%BA%8E%E6%98%AF%20%E5%B0%B1%E6%9C%89%E4%BA%86%E4%B8%80%E7%A7%8D%E6%8A%98%E4%B8%AD%E7%9A%84%E6%96%B9%E6%A1%88%EF%BC%9A%E4%B8%A4%E7%AB%AF%E5%AE%9A%E6%97%B6%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AA%E7%A9%BA%E5%8C%85%EF%BC%8C%E4%B8%80%E4%BD%86%E8%B6%85%E8%BF%87%E4%B8%80%E5%AE%9A%E6%97%B6%E9%97%B4%20%E6%9C%AA%E6%8E%A5%E6%94%B6%E5%88%B0%EF%BC%8C%E5%B0%B1%E8%AF%81%E6%98%8E%E5%AF%B9%E6%96%B9%E5%8F%AF%E8%83%BD%E7%BD%91%E7%BB%9C%E5%87%BA%E7%8E%B0%E4%BA%86%E9%97%AE%E9%A2%98%EF%BC%8C%E5%B0%B1%E5%8F%AF%E4%BB%A5%E4%B8%BB%E5%8A%A8%E5%85%B3%E9%97%AD%E4%BA%86%0A%0ATCP\-keepalive%0A%3Ecat%20%2Fproc%2Fsys%2Fnet%2Fipv4%2F%0A%0A3%E4%B8%AA%E9%87%8D%E8%A6%81%E5%8F%82%E6%95%B0%EF%BC%9A%3A%0Atcp\_keepalive\_time%EF%BC%9A%E9%BB%98%E8%AE%A4%207200%20%E7%A7%92%0Atcp\_keepalive\_probes%EF%BC%9A%E9%BB%98%E8%AE%A4%209%20%E6%AC%A1%0Atcp\_keepalive\_intvl%EF%BC%9A%E9%BB%98%E8%AE%A4%2075%20%E7%A7%92%0A%3E7200%E7%A7%92%E5%90%8E%EF%BC%8C%E5%AF%B9%E6%96%B9%E6%B2%A1%E6%9C%89%E5%93%8D%E5%BA%94%EF%BC%8C%E5%B0%B1%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AA%E6%8E%A2%E6%B5%8B%E5%8C%85%EF%BC%8C%E4%B9%8B%E5%90%8E%E6%AF%8F75%E7%A7%92%E5%90%8E%E5%86%8D%E5%8F%91%E9%80%81%E4%B8%80%E4%B8%AA%E5%8C%85%EF%BC%8C%E5%8F%91%E9%80%819%E6%AC%A1%E6%B2%A1%E5%93%8D%E5%BA%94%EF%BC%8C%E5%85%B3%E9%97%AD%E8%BF%9E%E6%8E%A5%0A%0A%E5%BA%94%E7%94%A8%E5%B1%82\-heartbeat%0A%E8%99%BD%E7%84%B6TCP%E5%B7%B2%E6%9C%89%E4%BA%86KEEPALIVE%EF%BC%8C%E4%BD%86%E9%97%AE%E9%A2%98%E6%98%AF%EF%BC%8C%E4%BB%A5TCP%E5%B1%82%EF%BC%8C%E5%8F%AA%E6%98%AF%E8%83%BD%E7%A1%AE%E5%AE%9A%EF%BC%8C%E8%BF%9E%E6%8E%A5%E6%98%AF%E5%90%A6%E5%AD%98%E5%9C%A8%20%EF%BC%8C%E5%B9%B6%E4%B8%8D%E8%83%BD%E7%A1%AE%E8%AE%A4%E8%AF%A5%E8%BF%9E%E6%8E%A5%E6%98%AF%E5%90%A6%E8%BF%98%E8%83%BD%E4%BC%A0%E8%BE%93%E6%95%B0%E6%8D%AE%EF%BC%8C%E6%AF%94%E5%A6%82%EF%BC%9A%E5%AF%B9%E6%96%B9%E4%B8%BB%E6%9C%BA%E5%81%87%E6%AD%BB%EF%BC%8C%E8%BF%9E%E6%8E%A5%E5%9C%A8%EF%BC%8C%E4%B8%8D%E8%83%BD%E6%8E%A5%E6%94%B6%E6%95%B0%E6%8D%AE%E4%BA%86%0A%0A%0A%E5%BE%85%E8%A7%A3%E5%86%B3%0A\-\-\-\-%0Ammap%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84%0ALINUX%E7%9A%84%E5%87%A0%E4%B8%AA%E6%8C%87%E4%BB%A4%E6%9F%A5%E7%9C%8B%E8%BF%9E%E6%8E%A5%E7%8A%B6%E6%80%81%EF%BC%9A%0Atcpdump%0Atraceroute%0Aping%0Anetstat%0Aroute%0APING%EF%BC%88Packet%20InterNet%20Groper%EF%BC%89%E4%B8%AD%E6%96%87%E5%90%8D%E4%B8%BA%E5%9B%A0%E7%89%B9%E7%BD%91%E5%8C%85%E6%8E%A2%E7%B4%A2%E5%99%A8%EF%BC%8C%E6%98%AF%E7%94%A8%E6%9D%A5%E6%9F%A5%E7%9C%8B%E7%BD%91%E7%BB%9C%E4%B8%8A%E5%8F%A6%E4%B8%80%E4%B8%AA%E4%B8%BB%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BD%91%E7%BB%9C%E8%BF%9E%E6%8E%A5%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B7%A5%E5%85%B7%E3%80%82%E5%90%91XX%E6%9C%BA%E5%99%A8%E5%8F%91%E9%80%81ICMP%E5%8C%85%0AICMP%0AInternet%20Control%20Message%20Protocol%26nbsp%3B%EF%BC%8C%E7%BD%91%E9%99%85%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AE%EF%BC%8C%E9%94%99%E8%AF%AF%E4%BE%A6%E6%B5%8B%E4%B8%8E%E5%9B%9E%E6%8A%A5%E6%9C%BA%E5%88%B6
